<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mptools: Creating nodes using make</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">mptools<span id="projectnumber">&#160;2.0.3</span>
   </div>
   <div id="projectbrief">Utility to create multipass virtual nodes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_07_usingmake.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Creating nodes using make </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>This is only documented in order ot explain some "advanced" concept in the makefile, mostly for historic reasons and for those interested in novel usage of makefiles. It is recommended to use the <code>mpn</code> script instead</dd></dl>
<p>The previous section showed how nodes could be manually created by giving a few parameters to the <code>mkmpnode</code> script as well as the simplified method with <code>mpn</code> using a strict naming convention of the nodes.</p>
<p >The makefile was the original method of creating nodes and for historic reason we finish with a short description of how the this method works.</p>
<p >The makefile method is functionally almost identical to the method with specifically named nodes with <code>mpn</code> as described above.</p>
<p >This is done with the makefile target <code>node</code>.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Examples of using the Makefile directly</h1>
<p >The makefile is used as the driver to create these named nodes. By default, the makefile have three nodes predefined which are created as so</p>
<div class="fragment"><div class="line">% make node</div>
</div><!-- fragment --><p >the following three default nodes are then prepared:</p>
<ul>
<li>ub18fs01 (Based on "bionic", a.k.a Ubuntu 18 LTS )</li>
<li>ub20fs01 (Based on "focal", a.k.a Ubuntu 20 LTS )</li>
<li>ub22fs01 (Based on "jammy", a.k.a Ubuntu 22 LTS )</li>
</ul>
<p >In order to build all nodes in parallel use the usual <code>-j</code> option to make. So for example to build up to four nodes in parallel call</p>
<div class="fragment"><div class="line">% make -j4 node</div>
</div><!-- fragment --><p >As their names suggest these nodes are created with a full development environment based on the cloud init template <code>fulldev-config.in</code> which installs a complete C/C++ development environment with some of the most commonly used libraries. All created machines are small.</p>
<p >In order to create a custom set of nodes the node names can either:</p>
<ol type="1">
<li>be supplied as overridden makefile variables (recommended) or</li>
<li>be setup by changing the  makefile variable in the makefile</li>
</ol>
<p >An example will clarify this.</p>
<p >Assume that we instead wanted to create two large Ubuntu 22 nodes with full development configuration and one X-Large Ubuntu 18 node with just the minimal dev environment. We can then override the <code>$(NODES)</code> makefile variable on the command line as so</p>
<div class="fragment"><div class="line">% make NODES=&quot;ub22fl11 ub22fl12 ub18mx13&quot; node</div>
</div><!-- fragment --><p >The makefile will "under the hood" then make the following three calls to the actual node creating script</p>
<div class="fragment"><div class="line">./mkmpnode.sh -r jammy -c cloud/fulldev-config.yaml -m 2GB -d 10GB ub22fl11</div>
<div class="line">./mkmpnode.sh -r jammy -c cloud/fulldev-config.yaml -m 2GB -d 10GB ub22fl12</div>
<div class="line">./mkmpnode.sh -r bionic -c cloud/minidev-config.yaml -m 4GB -d 15GB ub18mx13</div>
</div><!-- fragment --><p >Which will create two more large "jammy" (Ubuntu 22 LTS) nodes and one x-large "bionic" (Ubuntu 18 LTS) node exactly as the node names specified.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
Makefile targets</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Target   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>all</code>   </td><td class="markdownTableBodyNone">The default target that will instantiate all <code>*.yaml</code> files from the corresponding <code>*.in</code> templates.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>node</code>   </td><td class="markdownTableBodyNone">Create the nodes specified by the <code>$(NODES)</code> makefile variable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>clean</code>   </td><td class="markdownTableBodyNone">Delete all generated files    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>distclean</code>   </td><td class="markdownTableBodyNone">In addition to <code>clean</code> also remove any created distribution tar-ball.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dist</code>   </td><td class="markdownTableBodyNone">Create a distribution tar ball    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>install</code>   </td><td class="markdownTableBodyNone">Install the package (by default <code>/usr/loca</code> is used as prefix)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>uninstall</code>   </td><td class="markdownTableBodyNone">Uninstall the package    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>_dbg</code>   </td><td class="markdownTableBodyNone">Print all Makefile variables    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>docs</code>   </td><td class="markdownTableBodyNone">Generate documentation   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 15 2022 06:53:27 for mptools by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
